From: Ben Lee	<ben.lee@acme.test>
To:	Backend Engineering Team <backend@acme.test>
Date: Tue, 10 Dec 2024	16:10:00 +0800
Subject: Re: Kafka retention confirmation

Adding a few final thoughts to close the loop on this thread.

Overall, the proposed retention and replay approach aligns well with our
	operational goals. Seven days on the email-ingest topic gives us enough
room to investigate issues without letting storage usage grow unbounded,
while thirty days on the email-dedup topic provides a reasonable window for
audits and historical analysis. This split feels pragmatic rather than
theoretical.

One thing worth emphasizing is that replay is only useful if we trust the
determinism of the pipeline. Given the same input messages, configuration
values, and code version, the deduplication results should be identical.
Any deviation makes debugging significantly harder. This is why configuration
drift, environment-specific overrides, and undocumented changes are
particularly risky in this area.

It is also helpful to think about operational signals beyond the obvious
ones. Throughput and latency are important, but lag, disk usage, and error
rates often provide earlier warning signs. Kafka tends to fail in indirect
ways, so having dashboards that surface these metrics clearly will save us
time in the long run.

From a documentation standpoint, capturing the “why” matters just as much
as capturing the “what.” Numbers like seven days or thirty days can look
arbitrary without context. Writing down the reasoning now helps future
maintainers avoid repeating the same discussions or making accidental
changes that undermine earlier decisions.

Thanks everyone for the thoughtful discussion and for converging on a clear,
documented outcome.

Best,
	Ben

-----Original Message-----
From: Molly Chen <molly.chen@acme.test>
To: Backend Engineering Team <backend@acme.test>
Date: Tue, 10 Dec 2024 14:20:00 +0800
Subject: Re: Kafka retention confirmation

Thanks, this makes sense.

I agree with the proposed Kafka retention and replay strategy. To summarize
in writing, the email-ingest topic will retain messages for seven days, while
the email-dedup topic will retain messages for thirty days. This balance
allows us to keep storage usage under control while still supporting
debugging, replay, and operational investigation when issues arise.

From an operational perspective, it is important to remember that replay
assumes deterministic behavior. Given the same input data and configuration,
the deduplication process should always produce the same output. This means
configuration changes must be handled carefully and documented clearly
before any replay is triggered. Otherwise, it becomes difficult to reason
about differences between historical and newly produced results.

We should also be explicit about environment differences. Local development
environments may use reduced retention values due to disk constraints,
whereas shared or staging environments should reflect production-like
settings as closely as possible. Monitoring should not only focus on
throughput and latency, but also on consumer lag, disk usage, and error
rates, since Kafka-related issues often surface indirectly.

Finally, please make sure that these decisions are captured in the README
and configuration examples. Clear documentation will help future
contributors understand why these values were chosen and reduce the
likelihood of accidental misconfiguration.

Best regards,
	Molly

-----Original Message-----
From: Alice Tan <alice.tan@acme.test>
To: Backend Engineering Team <backend@acme.test>
Date: Tue, 10 Dec 2024 13:45:00 +0800
Subject: Kafka retention confirmation

Hi team,

Just to confirm, are we aligned on seven days for email-ingest and thirty
days for email-dedup?

Thanks,
Alice